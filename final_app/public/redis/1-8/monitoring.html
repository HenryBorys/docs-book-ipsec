<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Monitoring Redis for PCF |
    Pivotal Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
<script type="text/javascript">
  if (window.location.host === 'docs.pivotal.io') {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39702075-1']);
    _gaq.push(['_setDomainName', 'pivotal.io']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>

<script type="text/javascript">
  var blackList = ['acceptance'];

  blackList.forEach(function(blackListedEnv) {
    if (document.URL.indexOf(blackListedEnv) > -1 && blackListedEnv != "") {
      $('head').append('<meta name="hashtag" content="PivotalMoment">');
    }
  });
</script>

<!-- CrazyEgg Tracking Script -->
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0055/2990.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

<!-- Munchkin Marketo Script -->
<script type="text/javascript">
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
</script>

</head>

<body class="redis redis_1-8 redis_1-8_monitoring has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "pivotal.io";
    </script>

      <header class="global-header header header-layout js-bar-links">
    <a class="pivotal-logo" href="/">
    </a>
    <a href="/" class="global-header-title">
      <span class="title-deemph">Pivotal</span> Documentation
    </a>
    <div class="btn-menu" data-behavior="MenuMobile"></div>
    <div class="header-links">
      <div class="header-item">
        <a href="https://network.pivotal.io/">Downloads</a>
      </div>
      <div class="header-item">
        <a href="http://support.pivotal.io" target="_blank">Support</a>
      </div>

      <div class="header-item embedded-searchbar">
          <form method="get" action="/search">
            <input name="q" placeholder="Search Redis 1.8" class="search-box" />
            <input type="hidden" name="product_name" value="Pivotal Redis" />
              <input type="hidden" name="product_version" value="1.8"/>
          </form>
      </div>
      
    </div>
  </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav nav-container" role="navigation">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>


      <li class="has_submenu expanded">
        <a href="/redis/1-8/index.html">About Redis for PCF</a>
        <ul>
          <li>
            <a href="/redis/1-8/minor-overview.html">Overview of Redis for PCF v.1.7</a>
          </li>
          <li>
            <a href="/redis/1-8/release.html">Release Notes</a>
          </li>
          <li>
            <a href="/redis/1-8/architecture.html#config">How Redis for PCF Configures Redis</a>
          </li>
          <li>
            <a href="/redis/1-8/architecture.html#plans">Service Plans</a>
          </li>
          <li>
            <a href="/redis/1-8/architecture.html#architecture">Architecture</a>
          </li>
          <li>
            <a href="/redis/1-8/architecture.html#lifecycle">Lifecycle</a>
          </li>
          <li>
            <a href="/redis/1-8/recommended.html">Recommended Usage and Limitations</a>
          </li>
          <li>
            <a href="/redis/1-8/security.html">Security</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu expanded">
        <a href="/redis/1-8/maintain.html">Operator Guide</a>
        <ul>
          <li>
            <a href="/redis/1-8/installing.html">Installing Redis</a>
          </li>
          <li>
            <a href="/redis/1-8/installing.html#service-plans">Configuring Service Plans</a>
          </li>
          <li>
            <a href="/redis/1-8/installing.html#syslog">Configuring Syslog Output</a>
          </li>
          <li>
            <a href="/redis/1-8/installing.html#backup">Configuring Automated Backups</a>
          </li>
          <li>
            <a href="/redis/1-8/installing.html#azs">Networks, Security, and Assigning AZs</a>
          </li>          
          <li>
            <a href="/redis/1-8/installing.html#validation">Validating Install with Smoke Tests</a>
          </li>
          <li>
            <a href="/redis/1-8/manual-br.html#create">Creating Manual Backups</a>
          </li>
          <li>
            <a href="/redis/1-8/manual-br.html#restore">Restoring from Backups</a>
          </li>
          <li>
            <a href="/redis/1-8/monitoring.html">Monitoring and Metrics</a>
          </li>
          <li>
            <a href="/redis/1-8/installing.html#upgrades">Upgrading Redis for PCF</a>
          </li>
          <li>
            <a href="/redis/1-8/installing.html#uninstall">Uninstalling Redis for PCF</a>
          </li>
          <li>
            <a href="/redis/1-8/troubleshooting.html">Troubleshooting</a>
          </li>
        </ul>
      </li>

      <li class="has_submenu expanded">
        <a href="/redis/1-8/appdevs.html">Application Developer Guide</a>
        <ul>
          <li>
            <a href="/redis/1-8/appdevs.html#getting-started">Getting Started</a>
          </li>
          <li>
            <a href="/redis/1-8/architecture.html#service-plans">Service Plans</a>
          </li>
          <li>
            <a href="/redis/1-8/using.html#create">Creating a Redis Service Instance</a>
          </li>
          <li>
            <a href="/redis/1-8/using.html#bind">Binding an App to a Service Instance</a>
          </li>
          <li>
            <a href="/redis/1-8/using.html#delete">Deleting a Service Instance</a>
          </li>
          <li>
            <a href="/redis/1-8/recommended.html">Recommended Usage and Limitations</a>
          </li>
          <li>
            <a href="/redis/1-8/redisconf.html">Sample Redis Configuration</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</div><!--end of sub-nav-->





      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
          <div class="local-header title-container">
    <div class="local-header version-info">
      LATEST VERSION: 1.8 - <a href="">CHANGELOG</a>
    </div>
    <div class="local-header local-title clearfix">
      <img src="/images/cloud_rings.png">
      <span class="local-header-title">Pivotal Redis
      </span>
      <span class="local-header local-version header-dropdown">
        <a class="local-header header-dropdown-link">v1.8</a>
        <span class="local-header header-dropdown-content">
          <ul>
                <li>
                    <a href="http://docs.pivotal.io/redis/1-7/monitoring.html">v1.7</a>
                </li>
                <li>
                    <a href="http://docs.pivotal.io/redis/1-6/monitoring.html">v1.6</a>
                </li>
                <li>
                    <a href="http://docs.pivotal.io/redis/1-5/monitoring.html">v1.5</a>
                </li>
                <li>
                    <a href="http://docs.pivotal.io/redis/1-4/monitoring.html">v1.4</a>
                </li>
          </ul>
        </span>
      </span>

      <!-- search was here -->
    </div>
    <div class="local-header local-header-links">
    </div>
  </div>

          <h1 class="title-container" >
    Monitoring Redis for PCF
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#redis-metrics">Redis Metrics</a></li>
<li><a href="#other-metrics">Other Metrics</a></li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p>The PCF firehose exposes Redis metrics.</p>

<h3>Configuring Secure Communication</h3>

<p>Redis for PCF v1.7.2 adds the ability for the operator to turn on/off TLS communications for metrics, via a <code>Use non-secure communication for metrics</code> checkbox on the metrics configuration
page in Ops Manager. You should configure this checkbox for different versions of PCF as follow:</p>

<ul>
<li><p><strong>PCF v1.8</strong>: This checkbox must be checked for metrics to be emitted to the
Firehose. </p></li>
<li><p><strong>PCF v1.9</strong>: Metrics communications are secure by default but will work in a non-secure mode. </p></li>
<li><p><strong>PCF v1.10 and later</strong>: Metrics communications are secure by
default so this checkbox must be unchecked for metrics to be emitted to the Firehose. </p></li>
</ul>

<p><img alt="Configuring Secure Metrics" src="images/Enable-TLS.png" /></p>

<p>If this checkbox is incorrectly set, this error <code>Cannot generate manifest for product Redis: Error in (( .properties.metrics_disable_etcd_tls.value ? .properties.null_string.value : ..cf.properties.cf_etcd_client_cert.cert_pem )): unknown property &quot;cf_etcd_client_cert&quot; (Product &quot;Redis&quot; / Job: nil)</code> will be displayed:
<img alt="Configuring Secure Metrics error" src="images/TLS-error.png" /></p>

<h3>Polling Interval</h3>

<p>The metrics polling interval defaults to 30 seconds. This can be changed by navigating to the Metrics configuration page and entering a new value in <strong>Metrics polling interval (min: 10)</strong>.  </p>

<p><img alt="Metrics Polling Interval" src="images/metrics_polling.png" /></p>

<p>Third-party monitoring tools can consume Redis metrics to monitor Redis performance and health. For an example Datadog configuration that displays some of the significant metrics outlined below, see the <a href="https://github.com/pivotal-cf/metrics-datadog-dashboard">CF Redis example dashboard</a>. Pivotal does not endorse or provide support for any third party solution.</p>

<p>The following example shows the number of available instances for the Dedicated-VM plan metric:</p>

<pre class=terminal>
origin:"p-redis" eventType:ValueMetric timestamp:1480084323333475533 deployment:"cf-redis" job:"cf-redis-broker" index:"3be5f4b9-cdf3-45c4-a3b2-19d923d63a01" ip:"10.0.1.49" valueMetric:&#60;name:"/p-redis/service-broker/dedicated_vm_plan/available_instances" value:4 unit:"" >
</pre>

<h2><a id="redis-metrics"></a>Redis Metrics</h2>

<p>Redis emits a number of metrics that can be used to monitor the health and performance of your Redis deployment.</p>

<h3>keyspace_hits</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of successful lookups of keys in the main dictionary. &ldquo;/p-redis/info/stats/keyspace_hits&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>In conjunction with <code>keyspace_misses</code>, it can be used to calculate the hit ratio.</td>
</tr>
<tr>
  <th>Notes</th>
  <td>A successful lookup is a lookup on a key that exists.</td>
</tr>
</table>

<h3>keyspace_misses</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of unsuccessful lookups of keys in the main dictionary. &ldquo;/p-redis/info/stats/keyspace_misses&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>In conjunction with <code>keyspace_hits</code>, it can be used to calculate the hit ratio.</td>
</tr>
<tr>
  <th>Notes</th>
  <td>An unsuccessful lookup is a lookup on a key that does not exist.</td>
</tr>
</table>

<h3>used_memory</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of bytes allocated by Redis. &ldquo;/p-redis/info/memory/used_memory&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>Grows as the number of unsaved keys increases.</td>
</tr>
</table>

<h3>maxmemory</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Maximum number of bytes available in Redis. &ldquo;/p-redis/info/memory/maxmemory&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>Indicates the max memory available in Redis.</td>
</tr>
</table>

<h3>blocked_clients</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of connected clients pending on a blocking call. &ldquo;/p-redis/info/clients/blocked_clients&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>Can be used as an indicator to detect deadlocks.</td>
</tr>
</table>

<h3>connected_clients</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of clients connected to the Redis instance. &ldquo;/p-redis/info/clients/connected_clients&rdquo;
  </td>
</tr>
</table>

<h3>rdb_changes_since_last_save</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of keys currently in memory. &ldquo;/p-redis/info/persistence/rdb_changes_since_last_save&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>Memory usage grows in proportion to the number of keys in memory. If the Redis instance is stopped ungracefully, these changes may be lost.</td>
</tr>
<tr>
  <th>Notes</th>
  <td>Performing a <code>BGSAVE</code> writes these keys to disk and frees up memory.</td>
</tr>
</table>

<h3>total_commands_processed</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Total number of commands processed by Redis. &ldquo;/p-redis/info/stats/total_commands_processed&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>A crude indicator of activity. Can be used in conjunction with <code>uptime_in_seconds</code>.</td>
</tr>
</table>

<h3>mem_fragmentation_ratio</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Ratio of memory allocated by the operating system to the memory requested by Redis. &ldquo;/p-redis/info/memory/mem_fragmentation_ratio&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>A ratio in excess of 1.5 indicates excessive fragmentation, with your Redis instance consuming 150% of the physical memory it requested.</code>.</td>
</tr>
</table>

<h3>total_instances</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Total number of <code>dedicated-vm</code> instances of Redis. &ldquo;/p-redis/service-broker/dedicated_vm_plan/total_instances&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>Used in conjunction with <code>available_instances</code>, provides information about used instances.</td>
</tr>
</table>

<h3>available_instances</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of available <code>dedicated-vm</code> instances of Redis. &ldquo;/p-redis/service-broker/dedicated_vm_plan/available_instances&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>If zero, no more instances are available. </td>
</tr>
</table>

<h3>total_instances</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Total number of <code>shared-vm</code> instances of Redis. &ldquo;/p-redis/service-broker/shared_vm_plan/total_instances&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>Used in conjunction with <code>available_instances</code>, provides information about used instances.</td>
</tr>
</table>

<h3>available_instances</h3>

<table border='1' class='nice'>
<tr>
  <th width="22%">Description</th>
  <td>Number of available <code>shared-vm</code> instances of Redis. &ldquo;/p-redis/service-broker/shared_vm_plan/available_instances&rdquo;
  </td>
</tr>
<tr>
  <th>Significance</th>
  <td>If zero, no more instances are available. </td>
</tr>
</table>

<h2><a id="other-metrics"></a>Other Metrics</h2>

<p>Redis also exposes the following metrics. for more information, see the <a href="http://redis.io/commands/INFO">Redis documentation</a>.</p>

<ul>
<li><code>arch_bits</code></li>
<li><code>uptime_in_seconds</code></li>
<li><code>uptime_in_days</code></li>
<li><code>hz</code></li>
<li><code>lru_clock</code></li>
<li><code>client_longest_output_list</code></li>
<li><code>client_biggest_input_buf</code></li>
<li><code>used_memory_rss</code></li>
<li><code>used_memory_peak</code></li>
<li><code>used_memory_lua</code></li>
<li><code>mem_fragmentation_ratio</code></li>
<li><code>loading</code></li>
<li><code>rdb_bgsave_in_progress</code></li>
<li><code>rdb_last_save_time</code></li>
<li><code>rdb_last_bgsave_time_sec</code></li>
<li><code>rdb_current_bgsave_time_sec</code></li>
<li><code>aof_rewrite_in_progress</code></li>
<li><code>aof_rewrite_scheduled</code></li>
<li><code>aof_last_rewrite_time_sec</code></li>
<li><code>aof_current_rewrite_time_sec</code></li>
<li><code>total_connections_received</code></li>
<li><code>total_commands_processed</code></li>
<li><code>instantaneous_ops_per_sec</code></li>
<li><code>total_net_input_bytes</code></li>
<li><code>total_net_output_bytes</code></li>
<li><code>instantaneous_input_kbps</code></li>
<li><code>instantaneous_output_kbps</code></li>
<li><code>rejected_connections</code></li>
<li><code>sync_full</code></li>
<li><code>sync_partial_ok</code></li>
<li><code>sync_partial_err</code></li>
<li><code>expired_keys</code></li>
<li><code>evicted_keys</code></li>
<li><code>keyspace_hits</code></li>
<li><code>keyspace_misses</code></li>
<li><code>pubsub_channels</code></li>
<li><code>pubsub_patterns</code></li>
<li><code>latest_fork_usec</code></li>
<li><code>migrate_cached_sockets</code></li>
<li><code>connected_slaves</code></li>
<li><code>master_repl_offset</code></li>
<li><code>repl_backlog_active</code></li>
<li><code>repl_backlog_size</code></li>
<li><code>repl_backlog_first_byte_offset</code></li>
<li><code>repl_backlog_histlen</code></li>
<li><code>used_cpu_sys</code></li>
<li><code>used_cpu_user</code></li>
<li><code>used_cpu_sys_children</code></li>
<li><code>used_cpu_user_children</code></li>
<li><code>cluster_enabled</code></li>
<li><code>rdb_last_bgsave_status</code></li>
<li><code>aof_last_bgrewrite_status</code></li>
<li><code>aof_last_write_status</code></li>
</ul>

        <div><a id='repo-link' href='http://github.com/pivotal-cf/docs-redis/tree/1.8/monitoring.html.md.erb'>View the source for this page in GitHub</a></div>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='http://pivotal.io/privacy-policy'>Privacy Policy</a> | 
  <a href='http://pivotal.io/terms-of-use'>Terms of Use</a><br/>
  <a href='/'>Pivotal Documentation</a>
  &copy; 2017 <a href='http://pivotal.io'>Pivotal Software</a>, Inc. All Rights Reserved.
</div>
<div class="support">
  Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
